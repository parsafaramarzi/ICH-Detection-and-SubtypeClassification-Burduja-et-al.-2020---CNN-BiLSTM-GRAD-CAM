
[2025-12-04 00:42:11] --- STARTING TRAINING RUN ---
Starting training script on cuda:0
Loading and splitting master labels...
Training Patients: 52, Test Patients: 23
Found 75 unique patient scans.
Maximum total slice count observed: 58
The optimal (minimum) total number of slices to use for consistent sampling is: 31
Using 31 slices per scan based on data analysis.
Initializing Datasets...
Initializing FullModel...
Model ready.
Batch logs will be saved to: outputs/logs\training_batch_log_00006.csv
Epoch summary logs will be saved to: outputs/logs\training_epoch_log_00006.csv

--- Epoch 1 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 3.0720 | Primary Loss (BiLSTM): 2.0339 | Auxiliary Loss (CNN): 2.0762
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 2.8712 | Primary Loss (BiLSTM): 1.9486 | Auxiliary Loss (CNN): 1.8454
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 2.6407 | Primary Loss (BiLSTM): 1.8667 | Auxiliary Loss (CNN): 1.5480
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 2.4451 | Primary Loss (BiLSTM): 1.7849 | Auxiliary Loss (CNN): 1.3203
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 2.2227 | Primary Loss (BiLSTM): 1.7039 | Auxiliary Loss (CNN): 1.0377
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 2.5787 | Primary Loss (BiLSTM): 1.8251 | Auxiliary Loss (CNN): 1.5071
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 2.0383 | Primary Loss (BiLSTM): 1.5836 | Auxiliary Loss (CNN): 0.9094
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 1.9053 | Primary Loss (BiLSTM): 1.4916 | Auxiliary Loss (CNN): 0.8275
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 1.6938 | Primary Loss (BiLSTM): 1.3655 | Auxiliary Loss (CNN): 0.6565
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 1.5436 | Primary Loss (BiLSTM): 1.2695 | Auxiliary Loss (CNN): 0.5483
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 1.4069 | Primary Loss (BiLSTM): 1.1765 | Auxiliary Loss (CNN): 0.4607
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 1.2828 | Primary Loss (BiLSTM): 1.0827 | Auxiliary Loss (CNN): 0.4001
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 1.1701 | Primary Loss (BiLSTM): 0.9932 | Auxiliary Loss (CNN): 0.3537
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 1.0667 | Primary Loss (BiLSTM): 0.9062 | Auxiliary Loss (CNN): 0.3210
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 1.7004 | Primary Loss (BiLSTM): 1.1386 | Auxiliary Loss (CNN): 1.1235
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 0.8726 | Primary Loss (BiLSTM): 0.7393 | Auxiliary Loss (CNN): 0.2666
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 0.7900 | Primary Loss (BiLSTM): 0.6684 | Auxiliary Loss (CNN): 0.2432
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 1.4075 | Primary Loss (BiLSTM): 0.9629 | Auxiliary Loss (CNN): 0.8893
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 1.3131 | Primary Loss (BiLSTM): 0.9366 | Auxiliary Loss (CNN): 0.7529
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 0.6274 | Primary Loss (BiLSTM): 0.5016 | Auxiliary Loss (CNN): 0.2516
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 0.5764 | Primary Loss (BiLSTM): 0.4594 | Auxiliary Loss (CNN): 0.2340
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 1.5308 | Primary Loss (BiLSTM): 1.1079 | Auxiliary Loss (CNN): 0.8457
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 0.5178 | Primary Loss (BiLSTM): 0.3900 | Auxiliary Loss (CNN): 0.2557
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 0.4896 | Primary Loss (BiLSTM): 0.3622 | Auxiliary Loss (CNN): 0.2549
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 0.6611 | Primary Loss (BiLSTM): 0.4688 | Auxiliary Loss (CNN): 0.3846
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.4073 | Primary Loss (BiLSTM): 0.3101 | Auxiliary Loss (CNN): 0.1945
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 0.3742 | Primary Loss (BiLSTM): 0.2860 | Auxiliary Loss (CNN): 0.1763
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 0.3428 | Primary Loss (BiLSTM): 0.2627 | Auxiliary Loss (CNN): 0.1601
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 0.7065 | Primary Loss (BiLSTM): 0.5098 | Auxiliary Loss (CNN): 0.3934
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 0.2897 | Primary Loss (BiLSTM): 0.2233 | Auxiliary Loss (CNN): 0.1328
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.2676 | Primary Loss (BiLSTM): 0.2058 | Auxiliary Loss (CNN): 0.1236
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 1.3128 | Primary Loss (BiLSTM): 0.9100 | Auxiliary Loss (CNN): 0.8056
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 1.8307 | Primary Loss (BiLSTM): 1.2362 | Auxiliary Loss (CNN): 1.1890
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 1.8764 | Primary Loss (BiLSTM): 1.3168 | Auxiliary Loss (CNN): 1.1192
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 1.4135 | Primary Loss (BiLSTM): 1.0214 | Auxiliary Loss (CNN): 0.7843
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 0.2647 | Primary Loss (BiLSTM): 0.1682 | Auxiliary Loss (CNN): 0.1930
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 1.6210 | Primary Loss (BiLSTM): 1.1939 | Auxiliary Loss (CNN): 0.8541
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.2877 | Primary Loss (BiLSTM): 0.1694 | Auxiliary Loss (CNN): 0.2366
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 0.3040 | Primary Loss (BiLSTM): 0.1701 | Auxiliary Loss (CNN): 0.2678
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 0.3256 | Primary Loss (BiLSTM): 0.1701 | Auxiliary Loss (CNN): 0.3110
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 0.2809 | Primary Loss (BiLSTM): 0.1683 | Auxiliary Loss (CNN): 0.2252
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 0.6244 | Primary Loss (BiLSTM): 0.4444 | Auxiliary Loss (CNN): 0.3601
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 0.8944 | Primary Loss (BiLSTM): 0.6580 | Auxiliary Loss (CNN): 0.4727
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 0.6603 | Primary Loss (BiLSTM): 0.4387 | Auxiliary Loss (CNN): 0.4431
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 2.2623 | Primary Loss (BiLSTM): 1.6358 | Auxiliary Loss (CNN): 1.2530
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.2851 | Primary Loss (BiLSTM): 0.1675 | Auxiliary Loss (CNN): 0.2352
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.8212 | Primary Loss (BiLSTM): 0.5941 | Auxiliary Loss (CNN): 0.4542
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 0.2802 | Primary Loss (BiLSTM): 0.1743 | Auxiliary Loss (CNN): 0.2117
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 0.2843 | Primary Loss (BiLSTM): 0.1764 | Auxiliary Loss (CNN): 0.2158
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 0.4540 | Primary Loss (BiLSTM): 0.3172 | Auxiliary Loss (CNN): 0.2734
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 1.0802 | Primary Loss (BiLSTM): 0.7835 | Auxiliary Loss (CNN): 0.5934
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 0.2632 | Primary Loss (BiLSTM): 0.1749 | Auxiliary Loss (CNN): 0.1766
################################################################################

--- Epoch 1 Testing ---
Test Patient Macro AUC: 0.6364
Test Micro Accuracy: 0.8906 | Micro P/R/F1: 0.0000/0.0000/0.0000
Test Class AUCs: {'auc_intraparenchymal': 0.18794076163610718, 'auc_subdural': 0.2950549450549451, 'auc_epidural': 0.4424157303370787, 'auc_intraventricular': 0.4388182213524679, 'auc_subarachnoid': 0.41843470061291843, 'auc_any': 0.1526953361599031}
Checkpoint saved for epoch 1

--- Epoch 2 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 1.6129 | Primary Loss (BiLSTM): 1.1606 | Auxiliary Loss (CNN): 0.9046
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 0.6061 | Primary Loss (BiLSTM): 0.4287 | Auxiliary Loss (CNN): 0.3547
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 0.2569 | Primary Loss (BiLSTM): 0.1742 | Auxiliary Loss (CNN): 0.1654
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 1.2231 | Primary Loss (BiLSTM): 0.8863 | Auxiliary Loss (CNN): 0.6737
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 0.2626 | Primary Loss (BiLSTM): 0.1750 | Auxiliary Loss (CNN): 0.1751
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 0.2533 | Primary Loss (BiLSTM): 0.1752 | Auxiliary Loss (CNN): 0.1562
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 0.2461 | Primary Loss (BiLSTM): 0.1731 | Auxiliary Loss (CNN): 0.1460
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 0.2610 | Primary Loss (BiLSTM): 0.1696 | Auxiliary Loss (CNN): 0.1828
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 0.2594 | Primary Loss (BiLSTM): 0.1646 | Auxiliary Loss (CNN): 0.1895
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 1.0635 | Primary Loss (BiLSTM): 0.7812 | Auxiliary Loss (CNN): 0.5646
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 1.0159 | Primary Loss (BiLSTM): 0.7509 | Auxiliary Loss (CNN): 0.5299
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 0.6288 | Primary Loss (BiLSTM): 0.4230 | Auxiliary Loss (CNN): 0.4115
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 0.2108 | Primary Loss (BiLSTM): 0.1520 | Auxiliary Loss (CNN): 0.1176
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 0.2141 | Primary Loss (BiLSTM): 0.1497 | Auxiliary Loss (CNN): 0.1289
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 0.2082 | Primary Loss (BiLSTM): 0.1461 | Auxiliary Loss (CNN): 0.1242
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 1.1093 | Primary Loss (BiLSTM): 0.8194 | Auxiliary Loss (CNN): 0.5798
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 2.9526 | Primary Loss (BiLSTM): 2.0391 | Auxiliary Loss (CNN): 1.8271
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 0.2085 | Primary Loss (BiLSTM): 0.1414 | Auxiliary Loss (CNN): 0.1341
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 0.6748 | Primary Loss (BiLSTM): 0.4965 | Auxiliary Loss (CNN): 0.3566
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 1.3990 | Primary Loss (BiLSTM): 0.9994 | Auxiliary Loss (CNN): 0.7992
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 1.7062 | Primary Loss (BiLSTM): 1.2426 | Auxiliary Loss (CNN): 0.9272
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 0.2503 | Primary Loss (BiLSTM): 0.1476 | Auxiliary Loss (CNN): 0.2053
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 0.2367 | Primary Loss (BiLSTM): 0.1495 | Auxiliary Loss (CNN): 0.1744
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 0.2365 | Primary Loss (BiLSTM): 0.1500 | Auxiliary Loss (CNN): 0.1730
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 0.4193 | Primary Loss (BiLSTM): 0.2938 | Auxiliary Loss (CNN): 0.2511
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.7817 | Primary Loss (BiLSTM): 0.5861 | Auxiliary Loss (CNN): 0.3912
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 0.5906 | Primary Loss (BiLSTM): 0.4207 | Auxiliary Loss (CNN): 0.3399
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 0.2316 | Primary Loss (BiLSTM): 0.1465 | Auxiliary Loss (CNN): 0.1703
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 2.2595 | Primary Loss (BiLSTM): 1.6405 | Auxiliary Loss (CNN): 1.2380
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 0.2275 | Primary Loss (BiLSTM): 0.1476 | Auxiliary Loss (CNN): 0.1599
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.2501 | Primary Loss (BiLSTM): 0.1491 | Auxiliary Loss (CNN): 0.2019
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 0.2241 | Primary Loss (BiLSTM): 0.1484 | Auxiliary Loss (CNN): 0.1514
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 0.5635 | Primary Loss (BiLSTM): 0.4199 | Auxiliary Loss (CNN): 0.2871
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 0.2288 | Primary Loss (BiLSTM): 0.1458 | Auxiliary Loss (CNN): 0.1658
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 0.2043 | Primary Loss (BiLSTM): 0.1430 | Auxiliary Loss (CNN): 0.1227
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 0.2337 | Primary Loss (BiLSTM): 0.1402 | Auxiliary Loss (CNN): 0.1870
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 0.2063 | Primary Loss (BiLSTM): 0.1355 | Auxiliary Loss (CNN): 0.1417
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.6926 | Primary Loss (BiLSTM): 0.4830 | Auxiliary Loss (CNN): 0.4192
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 1.6251 | Primary Loss (BiLSTM): 1.1877 | Auxiliary Loss (CNN): 0.8748
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 0.2921 | Primary Loss (BiLSTM): 0.2008 | Auxiliary Loss (CNN): 0.1827
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 0.2865 | Primary Loss (BiLSTM): 0.1993 | Auxiliary Loss (CNN): 0.1742
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 0.4392 | Primary Loss (BiLSTM): 0.2993 | Auxiliary Loss (CNN): 0.2797
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 0.1692 | Primary Loss (BiLSTM): 0.1216 | Auxiliary Loss (CNN): 0.0951
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 0.1601 | Primary Loss (BiLSTM): 0.1185 | Auxiliary Loss (CNN): 0.0833
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 1.1730 | Primary Loss (BiLSTM): 0.8080 | Auxiliary Loss (CNN): 0.7300
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.1662 | Primary Loss (BiLSTM): 0.1146 | Auxiliary Loss (CNN): 0.1033
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.1525 | Primary Loss (BiLSTM): 0.1124 | Auxiliary Loss (CNN): 0.0801
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 0.1618 | Primary Loss (BiLSTM): 0.1107 | Auxiliary Loss (CNN): 0.1020
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 0.1493 | Primary Loss (BiLSTM): 0.1076 | Auxiliary Loss (CNN): 0.0835
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 1.9404 | Primary Loss (BiLSTM): 1.3867 | Auxiliary Loss (CNN): 1.1075
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 0.9627 | Primary Loss (BiLSTM): 0.6934 | Auxiliary Loss (CNN): 0.5387
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 0.1538 | Primary Loss (BiLSTM): 0.1042 | Auxiliary Loss (CNN): 0.0993
################################################################################

--- Epoch 2 Testing ---
Test Patient Macro AUC: 0.6364
Test Micro Accuracy: 0.8906 | Micro P/R/F1: 0.0000/0.0000/0.0000
Test Class AUCs: {'auc_intraparenchymal': 0.1413963328631876, 'auc_subdural': 0.303021978021978, 'auc_epidural': 0.1109550561797753, 'auc_intraventricular': 0.3392857142857143, 'auc_subarachnoid': 0.27345591702027344, 'auc_any': 0.3508479709267111}
Checkpoint saved for epoch 2

--- Epoch 3 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 0.1531 | Primary Loss (BiLSTM): 0.1039 | Auxiliary Loss (CNN): 0.0984
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 0.1488 | Primary Loss (BiLSTM): 0.1030 | Auxiliary Loss (CNN): 0.0918
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 0.1675 | Primary Loss (BiLSTM): 0.1017 | Auxiliary Loss (CNN): 0.1317
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 0.1519 | Primary Loss (BiLSTM): 0.0994 | Auxiliary Loss (CNN): 0.1051
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 0.4174 | Primary Loss (BiLSTM): 0.2830 | Auxiliary Loss (CNN): 0.2689
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 0.1348 | Primary Loss (BiLSTM): 0.0941 | Auxiliary Loss (CNN): 0.0814
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 0.6920 | Primary Loss (BiLSTM): 0.5113 | Auxiliary Loss (CNN): 0.3612
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 0.1525 | Primary Loss (BiLSTM): 0.0904 | Auxiliary Loss (CNN): 0.1242
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 0.1246 | Primary Loss (BiLSTM): 0.0876 | Auxiliary Loss (CNN): 0.0741
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 0.1187 | Primary Loss (BiLSTM): 0.0853 | Auxiliary Loss (CNN): 0.0668
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 0.1141 | Primary Loss (BiLSTM): 0.0827 | Auxiliary Loss (CNN): 0.0628
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 1.2478 | Primary Loss (BiLSTM): 0.9013 | Auxiliary Loss (CNN): 0.6929
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 0.6130 | Primary Loss (BiLSTM): 0.4510 | Auxiliary Loss (CNN): 0.3240
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 0.1183 | Primary Loss (BiLSTM): 0.0806 | Auxiliary Loss (CNN): 0.0755
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 1.8641 | Primary Loss (BiLSTM): 1.3406 | Auxiliary Loss (CNN): 1.0470
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 1.2268 | Primary Loss (BiLSTM): 0.9414 | Auxiliary Loss (CNN): 0.5709
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 0.1336 | Primary Loss (BiLSTM): 0.0877 | Auxiliary Loss (CNN): 0.0917
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 0.6066 | Primary Loss (BiLSTM): 0.4323 | Auxiliary Loss (CNN): 0.3485
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 1.7922 | Primary Loss (BiLSTM): 1.3907 | Auxiliary Loss (CNN): 0.8031
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 2.9834 | Primary Loss (BiLSTM): 2.0823 | Auxiliary Loss (CNN): 1.8022
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 0.2399 | Primary Loss (BiLSTM): 0.1092 | Auxiliary Loss (CNN): 0.2615
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 0.8188 | Primary Loss (BiLSTM): 0.6572 | Auxiliary Loss (CNN): 0.3232
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 2.1757 | Primary Loss (BiLSTM): 1.6732 | Auxiliary Loss (CNN): 1.0050
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 1.5762 | Primary Loss (BiLSTM): 1.2380 | Auxiliary Loss (CNN): 0.6765
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 0.3444 | Primary Loss (BiLSTM): 0.1461 | Auxiliary Loss (CNN): 0.3966
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.3498 | Primary Loss (BiLSTM): 0.1563 | Auxiliary Loss (CNN): 0.3871
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 0.3537 | Primary Loss (BiLSTM): 0.1642 | Auxiliary Loss (CNN): 0.3789
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 0.2816 | Primary Loss (BiLSTM): 0.1701 | Auxiliary Loss (CNN): 0.2230
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 0.2557 | Primary Loss (BiLSTM): 0.1727 | Auxiliary Loss (CNN): 0.1661
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 0.2445 | Primary Loss (BiLSTM): 0.1730 | Auxiliary Loss (CNN): 0.1430
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.2416 | Primary Loss (BiLSTM): 0.1691 | Auxiliary Loss (CNN): 0.1450
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 0.6143 | Primary Loss (BiLSTM): 0.4089 | Auxiliary Loss (CNN): 0.4108
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 0.1991 | Primary Loss (BiLSTM): 0.1593 | Auxiliary Loss (CNN): 0.0797
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 0.4150 | Primary Loss (BiLSTM): 0.2899 | Auxiliary Loss (CNN): 0.2502
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 0.6637 | Primary Loss (BiLSTM): 0.4163 | Auxiliary Loss (CNN): 0.4948
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 1.3977 | Primary Loss (BiLSTM): 0.8982 | Auxiliary Loss (CNN): 0.9990
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 0.1751 | Primary Loss (BiLSTM): 0.1385 | Auxiliary Loss (CNN): 0.0732
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.1775 | Primary Loss (BiLSTM): 0.1365 | Auxiliary Loss (CNN): 0.0820
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 0.1743 | Primary Loss (BiLSTM): 0.1329 | Auxiliary Loss (CNN): 0.0828
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 0.8460 | Primary Loss (BiLSTM): 0.5819 | Auxiliary Loss (CNN): 0.5282
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 0.1786 | Primary Loss (BiLSTM): 0.1281 | Auxiliary Loss (CNN): 0.1009
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 0.1728 | Primary Loss (BiLSTM): 0.1247 | Auxiliary Loss (CNN): 0.0961
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 0.1578 | Primary Loss (BiLSTM): 0.1183 | Auxiliary Loss (CNN): 0.0791
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 1.8606 | Primary Loss (BiLSTM): 1.2480 | Auxiliary Loss (CNN): 1.2251
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 1.0971 | Primary Loss (BiLSTM): 0.7912 | Auxiliary Loss (CNN): 0.6119
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.2878 | Primary Loss (BiLSTM): 0.1908 | Auxiliary Loss (CNN): 0.1940
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.1848 | Primary Loss (BiLSTM): 0.1157 | Auxiliary Loss (CNN): 0.1383
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 0.2066 | Primary Loss (BiLSTM): 0.1171 | Auxiliary Loss (CNN): 0.1792
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 1.0287 | Primary Loss (BiLSTM): 0.7686 | Auxiliary Loss (CNN): 0.5203
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 0.2845 | Primary Loss (BiLSTM): 0.1891 | Auxiliary Loss (CNN): 0.1908
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 1.3912 | Primary Loss (BiLSTM): 1.0220 | Auxiliary Loss (CNN): 0.7383
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 0.6568 | Primary Loss (BiLSTM): 0.4767 | Auxiliary Loss (CNN): 0.3602
################################################################################

--- Epoch 3 Testing ---
Test Patient Macro AUC: 0.6212
Test Micro Accuracy: 0.8906 | Micro P/R/F1: 0.0000/0.0000/0.0000
Test Class AUCs: {'auc_intraparenchymal': 0.09097320169252471, 'auc_subdural': 0.3697802197802198, 'auc_epidural': 0.0912921348314607, 'auc_intraventricular': 0.38371113285496844, 'auc_subarachnoid': 0.2626119754832626, 'auc_any': 0.5527155259438724}
Checkpoint saved for epoch 3

--- Epoch 4 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 0.1940 | Primary Loss (BiLSTM): 0.1167 | Auxiliary Loss (CNN): 0.1547
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 0.1781 | Primary Loss (BiLSTM): 0.1148 | Auxiliary Loss (CNN): 0.1266
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 0.2119 | Primary Loss (BiLSTM): 0.1186 | Auxiliary Loss (CNN): 0.1865
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 0.8433 | Primary Loss (BiLSTM): 0.6318 | Auxiliary Loss (CNN): 0.4229
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 1.6598 | Primary Loss (BiLSTM): 1.2073 | Auxiliary Loss (CNN): 0.9049
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 0.1832 | Primary Loss (BiLSTM): 0.1167 | Auxiliary Loss (CNN): 0.1330
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 2.8525 | Primary Loss (BiLSTM): 1.9594 | Auxiliary Loss (CNN): 1.7861
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 0.2090 | Primary Loss (BiLSTM): 0.1228 | Auxiliary Loss (CNN): 0.1724
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 0.2039 | Primary Loss (BiLSTM): 0.1248 | Auxiliary Loss (CNN): 0.1583
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 0.6339 | Primary Loss (BiLSTM): 0.4520 | Auxiliary Loss (CNN): 0.3639
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 0.1986 | Primary Loss (BiLSTM): 0.1268 | Auxiliary Loss (CNN): 0.1435
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 0.1944 | Primary Loss (BiLSTM): 0.1263 | Auxiliary Loss (CNN): 0.1362
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 0.1763 | Primary Loss (BiLSTM): 0.1222 | Auxiliary Loss (CNN): 0.1082
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 1.0034 | Primary Loss (BiLSTM): 0.7257 | Auxiliary Loss (CNN): 0.5555
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 1.3201 | Primary Loss (BiLSTM): 0.9406 | Auxiliary Loss (CNN): 0.7589
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 0.1941 | Primary Loss (BiLSTM): 0.1259 | Auxiliary Loss (CNN): 0.1364
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 0.5269 | Primary Loss (BiLSTM): 0.3864 | Auxiliary Loss (CNN): 0.2811
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 1.0482 | Primary Loss (BiLSTM): 0.7645 | Auxiliary Loss (CNN): 0.5674
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 0.2761 | Primary Loss (BiLSTM): 0.1946 | Auxiliary Loss (CNN): 0.1631
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 0.2164 | Primary Loss (BiLSTM): 0.1383 | Auxiliary Loss (CNN): 0.1562
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 0.5989 | Primary Loss (BiLSTM): 0.4036 | Auxiliary Loss (CNN): 0.3905
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 0.2144 | Primary Loss (BiLSTM): 0.1349 | Auxiliary Loss (CNN): 0.1589
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 1.4834 | Primary Loss (BiLSTM): 1.0879 | Auxiliary Loss (CNN): 0.7910
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 0.2974 | Primary Loss (BiLSTM): 0.1990 | Auxiliary Loss (CNN): 0.1968
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 0.2035 | Primary Loss (BiLSTM): 0.1391 | Auxiliary Loss (CNN): 0.1288
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.1918 | Primary Loss (BiLSTM): 0.1335 | Auxiliary Loss (CNN): 0.1166
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 1.5676 | Primary Loss (BiLSTM): 1.1452 | Auxiliary Loss (CNN): 0.8449
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 0.2237 | Primary Loss (BiLSTM): 0.1362 | Auxiliary Loss (CNN): 0.1749
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 0.4765 | Primary Loss (BiLSTM): 0.3123 | Auxiliary Loss (CNN): 0.3285
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 1.1061 | Primary Loss (BiLSTM): 0.7449 | Auxiliary Loss (CNN): 0.7225
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.2047 | Primary Loss (BiLSTM): 0.1337 | Auxiliary Loss (CNN): 0.1420
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 0.1712 | Primary Loss (BiLSTM): 0.1227 | Auxiliary Loss (CNN): 0.0969
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 0.7758 | Primary Loss (BiLSTM): 0.5521 | Auxiliary Loss (CNN): 0.4473
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 1.1970 | Primary Loss (BiLSTM): 0.8552 | Auxiliary Loss (CNN): 0.6835
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 0.1751 | Primary Loss (BiLSTM): 0.1220 | Auxiliary Loss (CNN): 0.1062
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 0.1850 | Primary Loss (BiLSTM): 0.1275 | Auxiliary Loss (CNN): 0.1151
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 0.1911 | Primary Loss (BiLSTM): 0.1265 | Auxiliary Loss (CNN): 0.1290
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.1879 | Primary Loss (BiLSTM): 0.1278 | Auxiliary Loss (CNN): 0.1202
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 0.1715 | Primary Loss (BiLSTM): 0.1202 | Auxiliary Loss (CNN): 0.1027
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 0.5366 | Primary Loss (BiLSTM): 0.3817 | Auxiliary Loss (CNN): 0.3098
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 0.1611 | Primary Loss (BiLSTM): 0.1049 | Auxiliary Loss (CNN): 0.1124
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 0.1349 | Primary Loss (BiLSTM): 0.0937 | Auxiliary Loss (CNN): 0.0825
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 0.3571 | Primary Loss (BiLSTM): 0.2476 | Auxiliary Loss (CNN): 0.2190
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 0.6400 | Primary Loss (BiLSTM): 0.4677 | Auxiliary Loss (CNN): 0.3447
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 1.9075 | Primary Loss (BiLSTM): 1.3398 | Auxiliary Loss (CNN): 1.1353
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.1298 | Primary Loss (BiLSTM): 0.0903 | Auxiliary Loss (CNN): 0.0790
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.1288 | Primary Loss (BiLSTM): 0.0904 | Auxiliary Loss (CNN): 0.0768
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 2.5063 | Primary Loss (BiLSTM): 1.7160 | Auxiliary Loss (CNN): 1.5806
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 0.1482 | Primary Loss (BiLSTM): 0.1055 | Auxiliary Loss (CNN): 0.0853
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 0.9210 | Primary Loss (BiLSTM): 0.6866 | Auxiliary Loss (CNN): 0.4689
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 0.1971 | Primary Loss (BiLSTM): 0.1292 | Auxiliary Loss (CNN): 0.1357
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 0.5715 | Primary Loss (BiLSTM): 0.3719 | Auxiliary Loss (CNN): 0.3992
################################################################################

--- Epoch 4 Testing ---
Test Patient Macro AUC: 0.6212
Test Micro Accuracy: 0.8906 | Micro P/R/F1: 0.0000/0.0000/0.0000
Test Class AUCs: {'auc_intraparenchymal': 0.16748942172073342, 'auc_subdural': 0.3750549450549451, 'auc_epidural': 0.1179775280898876, 'auc_intraventricular': 0.4284898891063275, 'auc_subarachnoid': 0.5068363979255068, 'auc_any': 0.550494649707248}
Checkpoint saved for epoch 4

--- Epoch 5 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 0.2113 | Primary Loss (BiLSTM): 0.1370 | Auxiliary Loss (CNN): 0.1486
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 1.4532 | Primary Loss (BiLSTM): 1.0543 | Auxiliary Loss (CNN): 0.7978
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 1.3078 | Primary Loss (BiLSTM): 0.9727 | Auxiliary Loss (CNN): 0.6701
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 0.2358 | Primary Loss (BiLSTM): 0.1499 | Auxiliary Loss (CNN): 0.1718
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 0.5378 | Primary Loss (BiLSTM): 0.3418 | Auxiliary Loss (CNN): 0.3919
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 0.4240 | Primary Loss (BiLSTM): 0.2787 | Auxiliary Loss (CNN): 0.2906
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 0.8431 | Primary Loss (BiLSTM): 0.6157 | Auxiliary Loss (CNN): 0.4547
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 0.3364 | Primary Loss (BiLSTM): 0.1905 | Auxiliary Loss (CNN): 0.2918
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 0.2504 | Primary Loss (BiLSTM): 0.1693 | Auxiliary Loss (CNN): 0.1622
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 0.2319 | Primary Loss (BiLSTM): 0.1563 | Auxiliary Loss (CNN): 0.1511
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 1.0829 | Primary Loss (BiLSTM): 0.6929 | Auxiliary Loss (CNN): 0.7800
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 1.0562 | Primary Loss (BiLSTM): 0.7603 | Auxiliary Loss (CNN): 0.5918
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 0.6954 | Primary Loss (BiLSTM): 0.5014 | Auxiliary Loss (CNN): 0.3880
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 0.2761 | Primary Loss (BiLSTM): 0.1796 | Auxiliary Loss (CNN): 0.1931
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 0.2392 | Primary Loss (BiLSTM): 0.1644 | Auxiliary Loss (CNN): 0.1496
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 0.2818 | Primary Loss (BiLSTM): 0.1795 | Auxiliary Loss (CNN): 0.2046
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 0.2280 | Primary Loss (BiLSTM): 0.1595 | Auxiliary Loss (CNN): 0.1370
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 0.2692 | Primary Loss (BiLSTM): 0.1765 | Auxiliary Loss (CNN): 0.1855
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 0.2330 | Primary Loss (BiLSTM): 0.1535 | Auxiliary Loss (CNN): 0.1590
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 0.2032 | Primary Loss (BiLSTM): 0.1410 | Auxiliary Loss (CNN): 0.1244
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 0.1735 | Primary Loss (BiLSTM): 0.1249 | Auxiliary Loss (CNN): 0.0972
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 0.1426 | Primary Loss (BiLSTM): 0.1028 | Auxiliary Loss (CNN): 0.0797
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 0.1842 | Primary Loss (BiLSTM): 0.1205 | Auxiliary Loss (CNN): 0.1274
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 0.1159 | Primary Loss (BiLSTM): 0.0828 | Auxiliary Loss (CNN): 0.0664
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 1.0468 | Primary Loss (BiLSTM): 0.7296 | Auxiliary Loss (CNN): 0.6345
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.1033 | Primary Loss (BiLSTM): 0.0735 | Auxiliary Loss (CNN): 0.0598
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 1.4533 | Primary Loss (BiLSTM): 0.9958 | Auxiliary Loss (CNN): 0.9150
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 0.0955 | Primary Loss (BiLSTM): 0.0684 | Auxiliary Loss (CNN): 0.0542
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 1.1142 | Primary Loss (BiLSTM): 0.7754 | Auxiliary Loss (CNN): 0.6776
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 0.1376 | Primary Loss (BiLSTM): 0.0918 | Auxiliary Loss (CNN): 0.0917
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.1037 | Primary Loss (BiLSTM): 0.0735 | Auxiliary Loss (CNN): 0.0603
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 0.1265 | Primary Loss (BiLSTM): 0.0885 | Auxiliary Loss (CNN): 0.0761
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 0.6740 | Primary Loss (BiLSTM): 0.4525 | Auxiliary Loss (CNN): 0.4428
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 2.4482 | Primary Loss (BiLSTM): 1.6772 | Auxiliary Loss (CNN): 1.5420
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 3.1068 | Primary Loss (BiLSTM): 2.0597 | Auxiliary Loss (CNN): 2.0941
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 0.2500 | Primary Loss (BiLSTM): 0.1715 | Auxiliary Loss (CNN): 0.1572
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 0.1538 | Primary Loss (BiLSTM): 0.1087 | Auxiliary Loss (CNN): 0.0903
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.1784 | Primary Loss (BiLSTM): 0.1228 | Auxiliary Loss (CNN): 0.1111
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 0.5058 | Primary Loss (BiLSTM): 0.3456 | Auxiliary Loss (CNN): 0.3203
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 0.2136 | Primary Loss (BiLSTM): 0.1376 | Auxiliary Loss (CNN): 0.1519
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 0.5060 | Primary Loss (BiLSTM): 0.3449 | Auxiliary Loss (CNN): 0.3222
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 0.5582 | Primary Loss (BiLSTM): 0.3872 | Auxiliary Loss (CNN): 0.3420
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 1.6155 | Primary Loss (BiLSTM): 1.1400 | Auxiliary Loss (CNN): 0.9511
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 0.2394 | Primary Loss (BiLSTM): 0.1605 | Auxiliary Loss (CNN): 0.1579
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 0.3095 | Primary Loss (BiLSTM): 0.2002 | Auxiliary Loss (CNN): 0.2187
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.6696 | Primary Loss (BiLSTM): 0.4657 | Auxiliary Loss (CNN): 0.4078
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.6079 | Primary Loss (BiLSTM): 0.4269 | Auxiliary Loss (CNN): 0.3620
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 0.2340 | Primary Loss (BiLSTM): 0.1571 | Auxiliary Loss (CNN): 0.1537
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 1.5035 | Primary Loss (BiLSTM): 1.0538 | Auxiliary Loss (CNN): 0.8994
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 0.2238 | Primary Loss (BiLSTM): 0.1505 | Auxiliary Loss (CNN): 0.1466
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 0.2140 | Primary Loss (BiLSTM): 0.1439 | Auxiliary Loss (CNN): 0.1402
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 0.4588 | Primary Loss (BiLSTM): 0.3267 | Auxiliary Loss (CNN): 0.2642
################################################################################

--- Epoch 5 Testing ---
Test Patient Macro AUC: 0.5682
Test Micro Accuracy: 0.8906 | Micro P/R/F1: 0.0000/0.0000/0.0000
Test Class AUCs: {'auc_intraparenchymal': 0.37447108603667134, 'auc_subdural': 0.331978021978022, 'auc_epidural': 0.4073033707865169, 'auc_intraventricular': 0.5832517938682322, 'auc_subarachnoid': 0.5825082508250826, 'auc_any': 0.6776297193620029}
Checkpoint saved for epoch 5

--- Epoch 6 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 0.4767 | Primary Loss (BiLSTM): 0.3291 | Auxiliary Loss (CNN): 0.2952
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 0.2060 | Primary Loss (BiLSTM): 0.1408 | Auxiliary Loss (CNN): 0.1304
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 0.1939 | Primary Loss (BiLSTM): 0.1333 | Auxiliary Loss (CNN): 0.1214
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 0.1804 | Primary Loss (BiLSTM): 0.1164 | Auxiliary Loss (CNN): 0.1281
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 0.1752 | Primary Loss (BiLSTM): 0.1175 | Auxiliary Loss (CNN): 0.1154
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 0.5326 | Primary Loss (BiLSTM): 0.3870 | Auxiliary Loss (CNN): 0.2914
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 0.1490 | Primary Loss (BiLSTM): 0.1033 | Auxiliary Loss (CNN): 0.0914
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 0.1582 | Primary Loss (BiLSTM): 0.1025 | Auxiliary Loss (CNN): 0.1115
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 0.1252 | Primary Loss (BiLSTM): 0.0892 | Auxiliary Loss (CNN): 0.0721
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 0.1502 | Primary Loss (BiLSTM): 0.1010 | Auxiliary Loss (CNN): 0.0985
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 1.4781 | Primary Loss (BiLSTM): 0.9912 | Auxiliary Loss (CNN): 0.9739
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 0.8426 | Primary Loss (BiLSTM): 0.5740 | Auxiliary Loss (CNN): 0.5373
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 1.6891 | Primary Loss (BiLSTM): 1.1519 | Auxiliary Loss (CNN): 1.0743
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 1.1961 | Primary Loss (BiLSTM): 0.8311 | Auxiliary Loss (CNN): 0.7300
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 0.1203 | Primary Loss (BiLSTM): 0.0780 | Auxiliary Loss (CNN): 0.0846
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 0.3583 | Primary Loss (BiLSTM): 0.2340 | Auxiliary Loss (CNN): 0.2486
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 0.2195 | Primary Loss (BiLSTM): 0.1272 | Auxiliary Loss (CNN): 0.1847
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 1.9340 | Primary Loss (BiLSTM): 1.3625 | Auxiliary Loss (CNN): 1.1428
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 0.2980 | Primary Loss (BiLSTM): 0.2012 | Auxiliary Loss (CNN): 0.1937
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 0.2277 | Primary Loss (BiLSTM): 0.1495 | Auxiliary Loss (CNN): 0.1564
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 0.3401 | Primary Loss (BiLSTM): 0.2155 | Auxiliary Loss (CNN): 0.2492
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 0.2620 | Primary Loss (BiLSTM): 0.1594 | Auxiliary Loss (CNN): 0.2052
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 0.2333 | Primary Loss (BiLSTM): 0.1584 | Auxiliary Loss (CNN): 0.1498
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 0.1998 | Primary Loss (BiLSTM): 0.1342 | Auxiliary Loss (CNN): 0.1312
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 0.2617 | Primary Loss (BiLSTM): 0.1690 | Auxiliary Loss (CNN): 0.1854
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.7038 | Primary Loss (BiLSTM): 0.4803 | Auxiliary Loss (CNN): 0.4470
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 0.8620 | Primary Loss (BiLSTM): 0.6014 | Auxiliary Loss (CNN): 0.5211
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 0.2461 | Primary Loss (BiLSTM): 0.1561 | Auxiliary Loss (CNN): 0.1799
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 0.1660 | Primary Loss (BiLSTM): 0.1137 | Auxiliary Loss (CNN): 0.1047
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 0.5361 | Primary Loss (BiLSTM): 0.3688 | Auxiliary Loss (CNN): 0.3347
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.4923 | Primary Loss (BiLSTM): 0.3336 | Auxiliary Loss (CNN): 0.3174
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 1.5667 | Primary Loss (BiLSTM): 1.0756 | Auxiliary Loss (CNN): 0.9823
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 0.8523 | Primary Loss (BiLSTM): 0.5770 | Auxiliary Loss (CNN): 0.5507
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 0.6296 | Primary Loss (BiLSTM): 0.4171 | Auxiliary Loss (CNN): 0.4249
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 0.7436 | Primary Loss (BiLSTM): 0.5171 | Auxiliary Loss (CNN): 0.4529
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 1.3132 | Primary Loss (BiLSTM): 0.8943 | Auxiliary Loss (CNN): 0.8378
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 0.2105 | Primary Loss (BiLSTM): 0.1438 | Auxiliary Loss (CNN): 0.1333
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.2104 | Primary Loss (BiLSTM): 0.1435 | Auxiliary Loss (CNN): 0.1339
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 0.1938 | Primary Loss (BiLSTM): 0.1365 | Auxiliary Loss (CNN): 0.1145
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 0.2510 | Primary Loss (BiLSTM): 0.1626 | Auxiliary Loss (CNN): 0.1768
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 0.8118 | Primary Loss (BiLSTM): 0.5549 | Auxiliary Loss (CNN): 0.5139
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 0.3869 | Primary Loss (BiLSTM): 0.2722 | Auxiliary Loss (CNN): 0.2294
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 0.2177 | Primary Loss (BiLSTM): 0.1587 | Auxiliary Loss (CNN): 0.1181
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 0.2187 | Primary Loss (BiLSTM): 0.1481 | Auxiliary Loss (CNN): 0.1411
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 0.4823 | Primary Loss (BiLSTM): 0.3245 | Auxiliary Loss (CNN): 0.3156
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.2475 | Primary Loss (BiLSTM): 0.1539 | Auxiliary Loss (CNN): 0.1870
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.1844 | Primary Loss (BiLSTM): 0.1275 | Auxiliary Loss (CNN): 0.1137
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 2.7909 | Primary Loss (BiLSTM): 1.8505 | Auxiliary Loss (CNN): 1.8808
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 0.0889 | Primary Loss (BiLSTM): 0.0539 | Auxiliary Loss (CNN): 0.0699
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 1.4767 | Primary Loss (BiLSTM): 1.0171 | Auxiliary Loss (CNN): 0.9192
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 0.1518 | Primary Loss (BiLSTM): 0.0960 | Auxiliary Loss (CNN): 0.1115
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 0.1688 | Primary Loss (BiLSTM): 0.1130 | Auxiliary Loss (CNN): 0.1117
################################################################################

--- Epoch 6 Testing ---
Test Patient Macro AUC: 0.4242
Test Micro Accuracy: 0.8906 | Micro P/R/F1: 0.0000/0.0000/0.0000
Test Class AUCs: {'auc_intraparenchymal': 0.2119181946403385, 'auc_subdural': 0.1532967032967033, 'auc_epidural': 0.2205056179775281, 'auc_intraventricular': 0.4592302674494455, 'auc_subarachnoid': 0.5037718057520038, 'auc_any': 0.8103977387441955}
Checkpoint saved for epoch 6

--- Epoch 7 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 0.4741 | Primary Loss (BiLSTM): 0.3179 | Auxiliary Loss (CNN): 0.3122
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 1.0162 | Primary Loss (BiLSTM): 0.6999 | Auxiliary Loss (CNN): 0.6326
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 1.6983 | Primary Loss (BiLSTM): 1.1243 | Auxiliary Loss (CNN): 1.1481
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 0.1776 | Primary Loss (BiLSTM): 0.1163 | Auxiliary Loss (CNN): 0.1225
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 0.4970 | Primary Loss (BiLSTM): 0.3452 | Auxiliary Loss (CNN): 0.3037
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 1.0894 | Primary Loss (BiLSTM): 0.7398 | Auxiliary Loss (CNN): 0.6993
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 0.2120 | Primary Loss (BiLSTM): 0.1481 | Auxiliary Loss (CNN): 0.1278
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 0.2944 | Primary Loss (BiLSTM): 0.2074 | Auxiliary Loss (CNN): 0.1740
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 0.2415 | Primary Loss (BiLSTM): 0.1724 | Auxiliary Loss (CNN): 0.1381
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 0.5382 | Primary Loss (BiLSTM): 0.3705 | Auxiliary Loss (CNN): 0.3354
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 0.1537 | Primary Loss (BiLSTM): 0.1058 | Auxiliary Loss (CNN): 0.0958
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 0.3584 | Primary Loss (BiLSTM): 0.2386 | Auxiliary Loss (CNN): 0.2397
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 0.1570 | Primary Loss (BiLSTM): 0.1131 | Auxiliary Loss (CNN): 0.0878
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 0.1410 | Primary Loss (BiLSTM): 0.0972 | Auxiliary Loss (CNN): 0.0877
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 0.5660 | Primary Loss (BiLSTM): 0.3863 | Auxiliary Loss (CNN): 0.3595
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 0.6740 | Primary Loss (BiLSTM): 0.4674 | Auxiliary Loss (CNN): 0.4132
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 0.0946 | Primary Loss (BiLSTM): 0.0602 | Auxiliary Loss (CNN): 0.0687
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 2.9910 | Primary Loss (BiLSTM): 2.0624 | Auxiliary Loss (CNN): 1.8572
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 0.2241 | Primary Loss (BiLSTM): 0.1574 | Auxiliary Loss (CNN): 0.1334
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 0.8788 | Primary Loss (BiLSTM): 0.5607 | Auxiliary Loss (CNN): 0.6361
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 0.5467 | Primary Loss (BiLSTM): 0.3689 | Auxiliary Loss (CNN): 0.3555
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 0.1761 | Primary Loss (BiLSTM): 0.1234 | Auxiliary Loss (CNN): 0.1053
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 1.0369 | Primary Loss (BiLSTM): 0.7009 | Auxiliary Loss (CNN): 0.6721
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 0.7419 | Primary Loss (BiLSTM): 0.5114 | Auxiliary Loss (CNN): 0.4609
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 0.2225 | Primary Loss (BiLSTM): 0.1564 | Auxiliary Loss (CNN): 0.1323
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.5946 | Primary Loss (BiLSTM): 0.4076 | Auxiliary Loss (CNN): 0.3740
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 0.2798 | Primary Loss (BiLSTM): 0.1805 | Auxiliary Loss (CNN): 0.1986
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 0.2977 | Primary Loss (BiLSTM): 0.1926 | Auxiliary Loss (CNN): 0.2103
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 1.2664 | Primary Loss (BiLSTM): 0.8684 | Auxiliary Loss (CNN): 0.7958
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 0.2307 | Primary Loss (BiLSTM): 0.1445 | Auxiliary Loss (CNN): 0.1724
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.2510 | Primary Loss (BiLSTM): 0.1778 | Auxiliary Loss (CNN): 0.1464
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 0.5746 | Primary Loss (BiLSTM): 0.3948 | Auxiliary Loss (CNN): 0.3596
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 0.2330 | Primary Loss (BiLSTM): 0.1619 | Auxiliary Loss (CNN): 0.1422
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 0.2402 | Primary Loss (BiLSTM): 0.1545 | Auxiliary Loss (CNN): 0.1715
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 0.2901 | Primary Loss (BiLSTM): 0.1865 | Auxiliary Loss (CNN): 0.2073
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 0.7853 | Primary Loss (BiLSTM): 0.5361 | Auxiliary Loss (CNN): 0.4985
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 0.1773 | Primary Loss (BiLSTM): 0.1269 | Auxiliary Loss (CNN): 0.1008
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.1530 | Primary Loss (BiLSTM): 0.1060 | Auxiliary Loss (CNN): 0.0941
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 0.2125 | Primary Loss (BiLSTM): 0.1449 | Auxiliary Loss (CNN): 0.1351
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 2.2622 | Primary Loss (BiLSTM): 1.5372 | Auxiliary Loss (CNN): 1.4499
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 0.1338 | Primary Loss (BiLSTM): 0.0981 | Auxiliary Loss (CNN): 0.0713
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 1.3641 | Primary Loss (BiLSTM): 0.9383 | Auxiliary Loss (CNN): 0.8516
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 0.3547 | Primary Loss (BiLSTM): 0.2496 | Auxiliary Loss (CNN): 0.2101
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 0.1704 | Primary Loss (BiLSTM): 0.1145 | Auxiliary Loss (CNN): 0.1117
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 0.1447 | Primary Loss (BiLSTM): 0.0939 | Auxiliary Loss (CNN): 0.1014
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.2875 | Primary Loss (BiLSTM): 0.1917 | Auxiliary Loss (CNN): 0.1916
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.2176 | Primary Loss (BiLSTM): 0.1420 | Auxiliary Loss (CNN): 0.1513
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 0.2779 | Primary Loss (BiLSTM): 0.1827 | Auxiliary Loss (CNN): 0.1903
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 0.1288 | Primary Loss (BiLSTM): 0.0866 | Auxiliary Loss (CNN): 0.0844
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 0.1939 | Primary Loss (BiLSTM): 0.1262 | Auxiliary Loss (CNN): 0.1354
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 0.3421 | Primary Loss (BiLSTM): 0.2262 | Auxiliary Loss (CNN): 0.2318
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 1.2608 | Primary Loss (BiLSTM): 0.8680 | Auxiliary Loss (CNN): 0.7856
################################################################################

--- Epoch 7 Testing ---
Test Patient Macro AUC: 0.4924
Test Micro Accuracy: 0.8906 | Micro P/R/F1: 0.0000/0.0000/0.0000
Test Class AUCs: {'auc_intraparenchymal': 0.25035260930888575, 'auc_subdural': 0.15945054945054946, 'auc_epidural': 0.1235955056179775, 'auc_intraventricular': 0.29799956512285286, 'auc_subarachnoid': 0.08793022159358796, 'auc_any': 0.5192610539067233}
Checkpoint saved for epoch 7

--- Epoch 8 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 1.4572 | Primary Loss (BiLSTM): 1.0019 | Auxiliary Loss (CNN): 0.9105
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 0.1856 | Primary Loss (BiLSTM): 0.1255 | Auxiliary Loss (CNN): 0.1201
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 0.9498 | Primary Loss (BiLSTM): 0.6296 | Auxiliary Loss (CNN): 0.6405
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 0.1357 | Primary Loss (BiLSTM): 0.0947 | Auxiliary Loss (CNN): 0.0819
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 1.4332 | Primary Loss (BiLSTM): 0.9391 | Auxiliary Loss (CNN): 0.9882
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 0.1450 | Primary Loss (BiLSTM): 0.1032 | Auxiliary Loss (CNN): 0.0835
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 0.7094 | Primary Loss (BiLSTM): 0.4729 | Auxiliary Loss (CNN): 0.4731
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 0.4219 | Primary Loss (BiLSTM): 0.2948 | Auxiliary Loss (CNN): 0.2540
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 0.1738 | Primary Loss (BiLSTM): 0.1188 | Auxiliary Loss (CNN): 0.1101
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 0.7093 | Primary Loss (BiLSTM): 0.4686 | Auxiliary Loss (CNN): 0.4814
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 0.7350 | Primary Loss (BiLSTM): 0.4858 | Auxiliary Loss (CNN): 0.4985
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 0.5238 | Primary Loss (BiLSTM): 0.3502 | Auxiliary Loss (CNN): 0.3471
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 0.2870 | Primary Loss (BiLSTM): 0.2044 | Auxiliary Loss (CNN): 0.1653
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 0.2392 | Primary Loss (BiLSTM): 0.1676 | Auxiliary Loss (CNN): 0.1432
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 0.2475 | Primary Loss (BiLSTM): 0.1795 | Auxiliary Loss (CNN): 0.1359
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 0.2378 | Primary Loss (BiLSTM): 0.1706 | Auxiliary Loss (CNN): 0.1344
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 0.2061 | Primary Loss (BiLSTM): 0.1414 | Auxiliary Loss (CNN): 0.1294
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 0.3620 | Primary Loss (BiLSTM): 0.2305 | Auxiliary Loss (CNN): 0.2629
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 0.2061 | Primary Loss (BiLSTM): 0.1459 | Auxiliary Loss (CNN): 0.1203
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 0.1841 | Primary Loss (BiLSTM): 0.1159 | Auxiliary Loss (CNN): 0.1363
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 0.1480 | Primary Loss (BiLSTM): 0.1016 | Auxiliary Loss (CNN): 0.0928
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 0.1421 | Primary Loss (BiLSTM): 0.0904 | Auxiliary Loss (CNN): 0.1034
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 0.1902 | Primary Loss (BiLSTM): 0.1284 | Auxiliary Loss (CNN): 0.1236
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 0.1354 | Primary Loss (BiLSTM): 0.0854 | Auxiliary Loss (CNN): 0.1001
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 0.0835 | Primary Loss (BiLSTM): 0.0515 | Auxiliary Loss (CNN): 0.0639
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.5578 | Primary Loss (BiLSTM): 0.3955 | Auxiliary Loss (CNN): 0.3245
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 0.0708 | Primary Loss (BiLSTM): 0.0439 | Auxiliary Loss (CNN): 0.0537
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 2.7596 | Primary Loss (BiLSTM): 1.9087 | Auxiliary Loss (CNN): 1.7018
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 0.6826 | Primary Loss (BiLSTM): 0.4710 | Auxiliary Loss (CNN): 0.4232
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 0.0609 | Primary Loss (BiLSTM): 0.0336 | Auxiliary Loss (CNN): 0.0547
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.0789 | Primary Loss (BiLSTM): 0.0503 | Auxiliary Loss (CNN): 0.0570
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 0.1153 | Primary Loss (BiLSTM): 0.0729 | Auxiliary Loss (CNN): 0.0848
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 0.0987 | Primary Loss (BiLSTM): 0.0655 | Auxiliary Loss (CNN): 0.0663
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 0.7083 | Primary Loss (BiLSTM): 0.4763 | Auxiliary Loss (CNN): 0.4639
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 0.7518 | Primary Loss (BiLSTM): 0.5133 | Auxiliary Loss (CNN): 0.4770
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 0.6903 | Primary Loss (BiLSTM): 0.4784 | Auxiliary Loss (CNN): 0.4238
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 0.1406 | Primary Loss (BiLSTM): 0.0959 | Auxiliary Loss (CNN): 0.0895
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.1367 | Primary Loss (BiLSTM): 0.0878 | Auxiliary Loss (CNN): 0.0976
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 0.4749 | Primary Loss (BiLSTM): 0.3266 | Auxiliary Loss (CNN): 0.2965
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 0.5278 | Primary Loss (BiLSTM): 0.3607 | Auxiliary Loss (CNN): 0.3343
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 1.2970 | Primary Loss (BiLSTM): 0.9086 | Auxiliary Loss (CNN): 0.7768
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 1.4594 | Primary Loss (BiLSTM): 0.9998 | Auxiliary Loss (CNN): 0.9192
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 0.8379 | Primary Loss (BiLSTM): 0.5760 | Auxiliary Loss (CNN): 0.5237
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 0.3747 | Primary Loss (BiLSTM): 0.2416 | Auxiliary Loss (CNN): 0.2663
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 2.8638 | Primary Loss (BiLSTM): 1.9088 | Auxiliary Loss (CNN): 1.9100
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.2292 | Primary Loss (BiLSTM): 0.1400 | Auxiliary Loss (CNN): 0.1785
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.2587 | Primary Loss (BiLSTM): 0.1548 | Auxiliary Loss (CNN): 0.2077
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 0.3426 | Primary Loss (BiLSTM): 0.2131 | Auxiliary Loss (CNN): 0.2591
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 0.2726 | Primary Loss (BiLSTM): 0.1599 | Auxiliary Loss (CNN): 0.2255
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 0.1945 | Primary Loss (BiLSTM): 0.1194 | Auxiliary Loss (CNN): 0.1503
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 1.3529 | Primary Loss (BiLSTM): 0.9643 | Auxiliary Loss (CNN): 0.7772
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 0.2292 | Primary Loss (BiLSTM): 0.1474 | Auxiliary Loss (CNN): 0.1635
################################################################################

--- Epoch 8 Testing ---
Test Patient Macro AUC: 0.5000
Test Micro Accuracy: 0.8906 | Micro P/R/F1: 0.0000/0.0000/0.0000
Test Class AUCs: {'auc_intraparenchymal': 0.19887165021156558, 'auc_subdural': 0.2376923076923077, 'auc_epidural': 0.3637640449438202, 'auc_intraventricular': 0.46349749945640356, 'auc_subarachnoid': 0.5363036303630364, 'auc_any': 0.7225116091257823}
Checkpoint saved for epoch 8

--- Epoch 9 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 0.2072 | Primary Loss (BiLSTM): 0.1421 | Auxiliary Loss (CNN): 0.1302
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 1.8850 | Primary Loss (BiLSTM): 1.2233 | Auxiliary Loss (CNN): 1.3234
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 0.4864 | Primary Loss (BiLSTM): 0.3382 | Auxiliary Loss (CNN): 0.2965
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 1.3015 | Primary Loss (BiLSTM): 0.9198 | Auxiliary Loss (CNN): 0.7633
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 0.2361 | Primary Loss (BiLSTM): 0.1810 | Auxiliary Loss (CNN): 0.1102
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 0.3030 | Primary Loss (BiLSTM): 0.2057 | Auxiliary Loss (CNN): 0.1946
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 0.1864 | Primary Loss (BiLSTM): 0.1301 | Auxiliary Loss (CNN): 0.1127
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 1.1556 | Primary Loss (BiLSTM): 0.8120 | Auxiliary Loss (CNN): 0.6873
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 0.1795 | Primary Loss (BiLSTM): 0.1233 | Auxiliary Loss (CNN): 0.1124
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 0.2840 | Primary Loss (BiLSTM): 0.2005 | Auxiliary Loss (CNN): 0.1669
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 0.1676 | Primary Loss (BiLSTM): 0.1165 | Auxiliary Loss (CNN): 0.1022
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 0.1938 | Primary Loss (BiLSTM): 0.1318 | Auxiliary Loss (CNN): 0.1239
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 0.2498 | Primary Loss (BiLSTM): 0.1593 | Auxiliary Loss (CNN): 0.1809
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 0.1538 | Primary Loss (BiLSTM): 0.0960 | Auxiliary Loss (CNN): 0.1155
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 0.2497 | Primary Loss (BiLSTM): 0.1547 | Auxiliary Loss (CNN): 0.1899
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 2.6828 | Primary Loss (BiLSTM): 1.8483 | Auxiliary Loss (CNN): 1.6691
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 0.1534 | Primary Loss (BiLSTM): 0.0978 | Auxiliary Loss (CNN): 0.1113
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 0.0854 | Primary Loss (BiLSTM): 0.0513 | Auxiliary Loss (CNN): 0.0682
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 0.0867 | Primary Loss (BiLSTM): 0.0509 | Auxiliary Loss (CNN): 0.0717
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 0.6204 | Primary Loss (BiLSTM): 0.3936 | Auxiliary Loss (CNN): 0.4536
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 0.3154 | Primary Loss (BiLSTM): 0.2062 | Auxiliary Loss (CNN): 0.2185
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 0.0979 | Primary Loss (BiLSTM): 0.0598 | Auxiliary Loss (CNN): 0.0761
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 0.8139 | Primary Loss (BiLSTM): 0.5670 | Auxiliary Loss (CNN): 0.4939
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 0.1837 | Primary Loss (BiLSTM): 0.1184 | Auxiliary Loss (CNN): 0.1305
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 0.0742 | Primary Loss (BiLSTM): 0.0371 | Auxiliary Loss (CNN): 0.0742
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.0539 | Primary Loss (BiLSTM): 0.0275 | Auxiliary Loss (CNN): 0.0528
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 1.3465 | Primary Loss (BiLSTM): 0.8975 | Auxiliary Loss (CNN): 0.8980
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 0.8759 | Primary Loss (BiLSTM): 0.5774 | Auxiliary Loss (CNN): 0.5971
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 1.4000 | Primary Loss (BiLSTM): 0.9159 | Auxiliary Loss (CNN): 0.9681
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 0.0823 | Primary Loss (BiLSTM): 0.0509 | Auxiliary Loss (CNN): 0.0627
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.9232 | Primary Loss (BiLSTM): 0.6330 | Auxiliary Loss (CNN): 0.5805
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 0.0781 | Primary Loss (BiLSTM): 0.0473 | Auxiliary Loss (CNN): 0.0617
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 0.3072 | Primary Loss (BiLSTM): 0.2067 | Auxiliary Loss (CNN): 0.2010
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 0.1455 | Primary Loss (BiLSTM): 0.0945 | Auxiliary Loss (CNN): 0.1021
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 0.9004 | Primary Loss (BiLSTM): 0.6057 | Auxiliary Loss (CNN): 0.5894
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 0.1773 | Primary Loss (BiLSTM): 0.1175 | Auxiliary Loss (CNN): 0.1196
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 0.7127 | Primary Loss (BiLSTM): 0.4687 | Auxiliary Loss (CNN): 0.4881
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.0835 | Primary Loss (BiLSTM): 0.0507 | Auxiliary Loss (CNN): 0.0655
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 0.4270 | Primary Loss (BiLSTM): 0.2884 | Auxiliary Loss (CNN): 0.2772
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 0.5804 | Primary Loss (BiLSTM): 0.4093 | Auxiliary Loss (CNN): 0.3422
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 0.1975 | Primary Loss (BiLSTM): 0.1376 | Auxiliary Loss (CNN): 0.1197
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 0.4266 | Primary Loss (BiLSTM): 0.3120 | Auxiliary Loss (CNN): 0.2292
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 0.6644 | Primary Loss (BiLSTM): 0.4232 | Auxiliary Loss (CNN): 0.4824
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 1.5039 | Primary Loss (BiLSTM): 0.9638 | Auxiliary Loss (CNN): 1.0802
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 0.2118 | Primary Loss (BiLSTM): 0.1630 | Auxiliary Loss (CNN): 0.0975
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.5504 | Primary Loss (BiLSTM): 0.3661 | Auxiliary Loss (CNN): 0.3686
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.5089 | Primary Loss (BiLSTM): 0.3556 | Auxiliary Loss (CNN): 0.3066
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 0.3151 | Primary Loss (BiLSTM): 0.2248 | Auxiliary Loss (CNN): 0.1806
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 0.2356 | Primary Loss (BiLSTM): 0.1793 | Auxiliary Loss (CNN): 0.1126
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 0.2628 | Primary Loss (BiLSTM): 0.1775 | Auxiliary Loss (CNN): 0.1706
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 0.9315 | Primary Loss (BiLSTM): 0.6151 | Auxiliary Loss (CNN): 0.6327
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 0.2215 | Primary Loss (BiLSTM): 0.1618 | Auxiliary Loss (CNN): 0.1193
################################################################################

--- Epoch 9 Testing ---
Test Patient Macro AUC: 0.3939
Test Micro Accuracy: 0.8906 | Micro P/R/F1: 0.0000/0.0000/0.0000
Test Class AUCs: {'auc_intraparenchymal': 0.37341325811001413, 'auc_subdural': 0.3280219780219781, 'auc_epidural': 0.5561797752808989, 'auc_intraventricular': 0.6375842574472711, 'auc_subarachnoid': 0.7593116454502593, 'auc_any': 0.6556430446194226}
Checkpoint saved for epoch 9

--- Epoch 10 Training Started ---
################################################################################
  Batch 1/52 | Total Loss: 0.2738 | Primary Loss (BiLSTM): 0.1921 | Auxiliary Loss (CNN): 0.1633
################################################################################
################################################################################
  Batch 2/52 | Total Loss: 0.1403 | Primary Loss (BiLSTM): 0.0955 | Auxiliary Loss (CNN): 0.0896
################################################################################
################################################################################
  Batch 3/52 | Total Loss: 1.5790 | Primary Loss (BiLSTM): 1.0499 | Auxiliary Loss (CNN): 1.0582
################################################################################
################################################################################
  Batch 4/52 | Total Loss: 0.5654 | Primary Loss (BiLSTM): 0.3603 | Auxiliary Loss (CNN): 0.4103
################################################################################
################################################################################
  Batch 5/52 | Total Loss: 0.2950 | Primary Loss (BiLSTM): 0.1887 | Auxiliary Loss (CNN): 0.2125
################################################################################
################################################################################
  Batch 6/52 | Total Loss: 1.0470 | Primary Loss (BiLSTM): 0.6946 | Auxiliary Loss (CNN): 0.7048
################################################################################
################################################################################
  Batch 7/52 | Total Loss: 0.1373 | Primary Loss (BiLSTM): 0.0893 | Auxiliary Loss (CNN): 0.0960
################################################################################
################################################################################
  Batch 8/52 | Total Loss: 0.7472 | Primary Loss (BiLSTM): 0.4942 | Auxiliary Loss (CNN): 0.5060
################################################################################
################################################################################
  Batch 9/52 | Total Loss: 0.1098 | Primary Loss (BiLSTM): 0.0624 | Auxiliary Loss (CNN): 0.0948
################################################################################
################################################################################
  Batch 10/52 | Total Loss: 0.1033 | Primary Loss (BiLSTM): 0.0552 | Auxiliary Loss (CNN): 0.0962
################################################################################
################################################################################
  Batch 11/52 | Total Loss: 0.4718 | Primary Loss (BiLSTM): 0.3219 | Auxiliary Loss (CNN): 0.2999
################################################################################
################################################################################
  Batch 12/52 | Total Loss: 0.4809 | Primary Loss (BiLSTM): 0.3454 | Auxiliary Loss (CNN): 0.2710
################################################################################
################################################################################
  Batch 13/52 | Total Loss: 0.1499 | Primary Loss (BiLSTM): 0.0838 | Auxiliary Loss (CNN): 0.1321
################################################################################
################################################################################
  Batch 14/52 | Total Loss: 1.7402 | Primary Loss (BiLSTM): 1.1882 | Auxiliary Loss (CNN): 1.1041
################################################################################
################################################################################
  Batch 15/52 | Total Loss: 0.1214 | Primary Loss (BiLSTM): 0.0679 | Auxiliary Loss (CNN): 0.1070
################################################################################
################################################################################
  Batch 16/52 | Total Loss: 0.0757 | Primary Loss (BiLSTM): 0.0400 | Auxiliary Loss (CNN): 0.0715
################################################################################
################################################################################
  Batch 17/52 | Total Loss: 0.6208 | Primary Loss (BiLSTM): 0.4172 | Auxiliary Loss (CNN): 0.4072
################################################################################
################################################################################
  Batch 18/52 | Total Loss: 0.1405 | Primary Loss (BiLSTM): 0.0959 | Auxiliary Loss (CNN): 0.0892
################################################################################
################################################################################
  Batch 19/52 | Total Loss: 0.1594 | Primary Loss (BiLSTM): 0.1155 | Auxiliary Loss (CNN): 0.0878
################################################################################
################################################################################
  Batch 20/52 | Total Loss: 0.2521 | Primary Loss (BiLSTM): 0.1718 | Auxiliary Loss (CNN): 0.1607
################################################################################
################################################################################
  Batch 21/52 | Total Loss: 2.7898 | Primary Loss (BiLSTM): 1.8541 | Auxiliary Loss (CNN): 1.8712
################################################################################
################################################################################
  Batch 22/52 | Total Loss: 0.4003 | Primary Loss (BiLSTM): 0.2516 | Auxiliary Loss (CNN): 0.2974
################################################################################
################################################################################
  Batch 23/52 | Total Loss: 0.5918 | Primary Loss (BiLSTM): 0.4021 | Auxiliary Loss (CNN): 0.3795
################################################################################
################################################################################
  Batch 24/52 | Total Loss: 0.0978 | Primary Loss (BiLSTM): 0.0513 | Auxiliary Loss (CNN): 0.0929
################################################################################
################################################################################
  Batch 25/52 | Total Loss: 0.2970 | Primary Loss (BiLSTM): 0.2131 | Auxiliary Loss (CNN): 0.1679
################################################################################
################################################################################
  Batch 26/52 | Total Loss: 0.0788 | Primary Loss (BiLSTM): 0.0356 | Auxiliary Loss (CNN): 0.0864
################################################################################
################################################################################
  Batch 27/52 | Total Loss: 0.8345 | Primary Loss (BiLSTM): 0.5523 | Auxiliary Loss (CNN): 0.5645
################################################################################
################################################################################
  Batch 28/52 | Total Loss: 0.4538 | Primary Loss (BiLSTM): 0.3212 | Auxiliary Loss (CNN): 0.2651
################################################################################
################################################################################
  Batch 29/52 | Total Loss: 0.3663 | Primary Loss (BiLSTM): 0.2405 | Auxiliary Loss (CNN): 0.2515
################################################################################
################################################################################
  Batch 30/52 | Total Loss: 0.8183 | Primary Loss (BiLSTM): 0.5287 | Auxiliary Loss (CNN): 0.5792
################################################################################
################################################################################
  Batch 31/52 | Total Loss: 0.0585 | Primary Loss (BiLSTM): 0.0259 | Auxiliary Loss (CNN): 0.0652
################################################################################
################################################################################
  Batch 32/52 | Total Loss: 0.1185 | Primary Loss (BiLSTM): 0.0658 | Auxiliary Loss (CNN): 0.1052
################################################################################
################################################################################
  Batch 33/52 | Total Loss: 0.0548 | Primary Loss (BiLSTM): 0.0244 | Auxiliary Loss (CNN): 0.0609
################################################################################
################################################################################
  Batch 34/52 | Total Loss: 0.0656 | Primary Loss (BiLSTM): 0.0260 | Auxiliary Loss (CNN): 0.0792
################################################################################
################################################################################
  Batch 35/52 | Total Loss: 0.4353 | Primary Loss (BiLSTM): 0.2818 | Auxiliary Loss (CNN): 0.3070
################################################################################
################################################################################
  Batch 36/52 | Total Loss: 1.0017 | Primary Loss (BiLSTM): 0.7207 | Auxiliary Loss (CNN): 0.5620
################################################################################
################################################################################
  Batch 37/52 | Total Loss: 0.1581 | Primary Loss (BiLSTM): 0.0960 | Auxiliary Loss (CNN): 0.1241
################################################################################
################################################################################
  Batch 38/52 | Total Loss: 0.8709 | Primary Loss (BiLSTM): 0.6149 | Auxiliary Loss (CNN): 0.5120
################################################################################
################################################################################
  Batch 39/52 | Total Loss: 0.1337 | Primary Loss (BiLSTM): 0.0814 | Auxiliary Loss (CNN): 0.1045
################################################################################
################################################################################
  Batch 40/52 | Total Loss: 0.6350 | Primary Loss (BiLSTM): 0.4189 | Auxiliary Loss (CNN): 0.4322
################################################################################
################################################################################
  Batch 41/52 | Total Loss: 0.0688 | Primary Loss (BiLSTM): 0.0316 | Auxiliary Loss (CNN): 0.0745
################################################################################
################################################################################
  Batch 42/52 | Total Loss: 0.1058 | Primary Loss (BiLSTM): 0.0608 | Auxiliary Loss (CNN): 0.0899
################################################################################
################################################################################
  Batch 43/52 | Total Loss: 1.4118 | Primary Loss (BiLSTM): 0.9244 | Auxiliary Loss (CNN): 0.9747
################################################################################
################################################################################
  Batch 44/52 | Total Loss: 0.5442 | Primary Loss (BiLSTM): 0.3660 | Auxiliary Loss (CNN): 0.3565
################################################################################
################################################################################
  Batch 45/52 | Total Loss: 0.2980 | Primary Loss (BiLSTM): 0.2139 | Auxiliary Loss (CNN): 0.1681
################################################################################
################################################################################
  Batch 46/52 | Total Loss: 0.4912 | Primary Loss (BiLSTM): 0.3565 | Auxiliary Loss (CNN): 0.2695
################################################################################
################################################################################
  Batch 47/52 | Total Loss: 0.2382 | Primary Loss (BiLSTM): 0.1611 | Auxiliary Loss (CNN): 0.1542
################################################################################
################################################################################
  Batch 48/52 | Total Loss: 0.2813 | Primary Loss (BiLSTM): 0.2009 | Auxiliary Loss (CNN): 0.1610
################################################################################
################################################################################
  Batch 49/52 | Total Loss: 0.4823 | Primary Loss (BiLSTM): 0.3416 | Auxiliary Loss (CNN): 0.2815
################################################################################
################################################################################
  Batch 50/52 | Total Loss: 1.2452 | Primary Loss (BiLSTM): 0.8165 | Auxiliary Loss (CNN): 0.8575
################################################################################
################################################################################
  Batch 51/52 | Total Loss: 0.1692 | Primary Loss (BiLSTM): 0.1211 | Auxiliary Loss (CNN): 0.0963
################################################################################
################################################################################
  Batch 52/52 | Total Loss: 0.1735 | Primary Loss (BiLSTM): 0.1129 | Auxiliary Loss (CNN): 0.1212
################################################################################

--- Epoch 10 Testing ---
Test Patient Macro AUC: 0.4470
Test Micro Accuracy: 0.1529 | Micro P/R/F1: 0.1145/0.4304/0.1809
Test Class AUCs: {'auc_intraparenchymal': 0.09273624823695345, 'auc_subdural': 0.20516483516483516, 'auc_epidural': 0.1980337078651685, 'auc_intraventricular': 0.3664111763426832, 'auc_subarachnoid': 0.3943894389438944, 'auc_any': 0.5973955178679589}
Checkpoint saved for epoch 10

Training complete after 10 epochs.

[2025-12-04 00:50:34] --- TRAINING RUN ENDED ---
